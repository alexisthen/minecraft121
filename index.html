<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Terrain Loading</title>
    <link href="https://fonts.cdnfonts.com/css/minecraft" rel="stylesheet">
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #87CEEB; /* Sky blue */
            color: #000;
            text-align: center;
            overflow: hidden; /* Prevent scrollbars during 3D rendering */
        }

        #loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            color: #fff;
            display: none;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            z-index: 1000;
        }

        #terrain {
            margin-top: 20px;
            white-space: pre;
            font-family: 'Minecraft', sans-serif;
            display: none; /* Hidden until terrain is generated */
        }

        .game-mode {
            margin: 20px;
        }

        canvas {
            display: block; /* Remove margins for the canvas */
            width: 100%;
            height: 100vh; /* Full height */
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
</head>

<body>

    <h1>Terrain Generation Simulation</h1>
    <div id="loading-screen">
        <h2>Loading Terrain...</h2>
        <div class="tip" id="random-tip"></div>
    </div>
    <div id="terrain"></div>
    <select id="gameModeSelector" class="game-mode">
        <option value="">Choose a game mode</option>
        <option value="generate">Generate Terrain</option>
    </select>

    <script>
        const tips = [
            "Tip: Always carry a pickaxe!",
            "Tip: Watch out for creepers!",
            "Tip: Build a shelter at night.",
            "Tip: Keep food in your inventory.",
            "Tip: Water can help you in many situations."
        ];

        document.getElementById('gameModeSelector').addEventListener('change', function () {
            if (this.value === 'generate') {
                const loadingScreen = document.getElementById('loading-screen');
                const randomTip = tips[Math.floor(Math.random() * tips.length)];
                document.getElementById('random-tip').innerText = randomTip;

                // Show loading screen
                loadingScreen.style.display = 'flex';

                // Simulate loading with a timeout
                setTimeout(() => {
                    loadingScreen.style.display = 'none'; // Hide loading screen
                    generateTerrain(); // Generate the terrain
                }, 2000);
            }
        });

        function generateTerrain() {
            const height = 20; // Landscape height
            let terrain = '';

            for (let y = height; y >= 0; y--) {
                let layer = '';

                if (y === height) {
                    layer = 'Grass\n'; // Top layer is grass
                } else if (y >= height - 3) {
                    layer = 'Dirt\n'; // Next 3 layers are dirt
                } else if (y > 8) {
                    layer = getStoneLayer(y); // Stone layers
                } else {
                    layer = getDeepslateLayer(y); // Below Y=8
                }

                terrain += layer;
            }

            document.getElementById('terrain').innerText = terrain;
            document.getElementById('terrain').style.display = 'block'; // Show generated terrain

            // Start the 3D game
            start3DGame(terrain.split('\n'));
        }

        function getStoneLayer(y) {
            const chance = Math.random();
            if (chance < 0.1) {
                return 'Andesite\n'; // 10% chance for Andesite
            } else if (chance < 0.2) {
                return 'Diorite\n'; // 10% chance for Diorite
            }
            return 'Stone\n'; // Default stone
        }

        function getDeepslateLayer(y) {
            const ores = ['Deepslate\n', 'Deepslate\n', 'Deepslate\n']; // Base material (Deepslate)

            // Determine if this is a mountainous layer, assuming y > 15 represents a mountain peak
            const isMountainousLayer = y > 15; 

            // Adding ores randomly below Y=8
            if (isMountainousLayer) {
                const emeraldChance = Math.random();
                if (emeraldChance < 0.05) {
                    ores.push('Emerald Ore\n'); // 5% chance for Emerald
                }
            }

            switch (y) {
                case 1: case 2:
                    ores.push('Emerald Ore\n'); break; // Rare, but can accidentally double
                case 3: case 4: case 5:
                    ores.push('Diamond Ore\n'); break; // Rare
                case 6: case 7:
                    ores.push('Gold Ore\n'); break; // More common than diamonds
                case 8:
                    ores.push('Iron Ore\n'); break; // Most common
            }

            return ores[Math.floor(Math.random() * ores.length)]; // Randomly return a layer
        }

        function start3DGame(layers) {
            // Create a basic Three.js scene
            const scene = new THREE.Scene();
            const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            const renderer = new THREE.WebGLRenderer();
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.body.appendChild(renderer.domElement);

            const materials = {
                'Grass': new THREE.MeshStandardMaterial({ color: 0x7CFC00 }),
                'Dirt': new THREE.MeshStandardMaterial({ color: 0x8B4513 }),
                'Stone': new THREE.MeshStandardMaterial({ color: 0x808080 }),
                'Deepslate': new THREE.MeshStandardMaterial({ color: 0x000000 }),
                'Andesite': new THREE.MeshStandardMaterial({ color: 0xA9A9A9 }),
                'Diorite': new THREE.MeshStandardMaterial({ color: 0xF5F5F5 }),
                'Emerald Ore': new THREE.MeshStandardMaterial({ color: 0x50C878 }),
                'Diamond Ore': new THREE.MeshStandardMaterial({ color: 0x3CB371 }),
                'Gold Ore': new THREE.MeshStandardMaterial({ color: 0xFFD700 }),
                'Iron Ore': new THREE.MeshStandardMaterial({ color: 0xB87333 })
            };

            let currentY = layers.length;
            layers.forEach((layer) => {
                const geometry = new THREE.BoxGeometry(1, 1, 1);
                const material = materials[layer.trim()] || materials['Stone']; // Default to Stone if not specified
                const cube = new THREE.Mesh(geometry, material);

                cube.position.y = currentY - 1; // Position it based on layer order
                scene.add(cube);
                currentY--;
            });

            camera.position.z = 5;
            camera.position.y = layers.length / 2;

            const light = new THREE.PointLight(0xffffff, 1, 100);
            light.position.set(5, 5, 5);
            scene.add(light);

            function animate() {
                requestAnimationFrame(animate);
                renderer.render(scene, camera);
            }

            animate();
        }
    </script>
</body>

</html>
